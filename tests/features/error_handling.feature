# language: zh-CN
功能: 错误处理
  作为一个钱包机器人
  我需要能够正确处理各种错误情况
  以便为用户提供清晰的错误信息

  背景:
    假设 系统已经初始化

  场景: 处理无效的消息格式
    假设 我收到一条消息 "无效的消息格式"
    当 我尝试解析这条消息
    那么 应该返回解析错误
    并且 错误信息应该包含 "无效的消息格式"

  场景: 处理缺少钱包名称的消息
    假设 我收到一条消息 "#12月 #2024年\n#收入 100.00元"
    当 我尝试解析这条消息
    那么 应该返回解析错误
    并且 错误信息应该包含 "缺少钱包名称"

  场景: 处理缺少月份的消息
    假设 我收到一条消息 "#支付宝 #2024年\n#收入 100.00元"
    当 我尝试解析这条消息
    那么 应该返回解析错误
    并且 错误信息应该包含 "缺少月份"

  场景: 处理缺少年份的消息
    假设 我收到一条消息 "#支付宝 #12月\n#收入 100.00元"
    当 我尝试解析这条消息
    那么 应该返回解析错误
    并且 错误信息应该包含 "缺少年份"

  场景: 处理缺少金额的消息
    假设 我收到一条消息 "#支付宝 #12月 #2024年\n#收入"
    当 我尝试解析这条消息
    那么 应该返回解析错误
    并且 错误信息应该包含 "缺少金额"

  场景: 处理不存在的用户
    假设 用户 "nonexistent_user" 不存在
    当 我尝试获取用户 "nonexistent_user" 的钱包
    那么 应该返回用户不存在错误

  场景: 处理数据库连接错误
    假设 数据库连接失败
    当 我尝试执行数据库操作
    那么 应该返回数据库错误
    并且 错误类型应该是 "Database"

  场景: 处理网络错误
    假设 网络连接失败
    当 我尝试发送消息
    那么 应该返回网络错误
    并且 错误类型应该是 "Network"

  场景: 处理重复的交易
    假设 用户 "test_user" 已经有钱包
    并且 已经存在一笔交易 ID 为 "tx123"
    当 我尝试添加相同 ID 的交易
    那么 应该返回重复交易错误
    并且 错误信息应该包含 "交易已存在" 