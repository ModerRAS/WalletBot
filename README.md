# WalletBot é’±åŒ…æœºå™¨äºº

ä¸€ä¸ªåŸºäº Rust å’Œ Teloxide çš„ Telegram é’±åŒ…ç®¡ç†æœºå™¨äººã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“± **æ™ºèƒ½æ¶ˆæ¯è§£æ**: è‡ªåŠ¨è¯†åˆ«å¹¶è§£æé’±åŒ…äº¤æ˜“æ¶ˆæ¯
- ğŸ’° **å®æ—¶ä½™é¢è®¡ç®—**: æ™ºèƒ½è®¡ç®—é’±åŒ…ä½™é¢å¹¶è‡ªåŠ¨æ›´æ–°
- ğŸ—„ï¸ **æ•°æ®åº“å­˜å‚¨**: ä½¿ç”¨ SQLite å­˜å‚¨äº¤æ˜“è®°å½•å’Œé’±åŒ…ä¿¡æ¯
- ğŸ”„ **é‡å¤æ¶ˆæ¯å¤„ç†**: é˜²æ­¢é‡å¤å¤„ç†ç›¸åŒçš„æ¶ˆæ¯
- ğŸ“Š **æ”¯æŒå¤šç§äº¤æ˜“ç±»å‹**: æ”¯æŒå‡ºè´¦ã€å…¥è´¦ç­‰å¤šç§äº¤æ˜“ç±»å‹
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Rust 1.70+
- Telegram Bot Token

### å®‰è£…

```bash
git clone https://github.com/your-username/WalletBot.git
cd WalletBot
cargo build --release
```

### é…ç½®

1. å¤åˆ¶é…ç½®æ–‡ä»¶ï¼š
```bash
cp config.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„ Telegram Bot Tokenï¼š
```
TELEGRAM_BOT_TOKEN=your_bot_token_here
DATABASE_URL=wallet.db
BOT_NAME=WalletBot
MAX_RETRY_ATTEMPTS=3
PROCESSING_TIMEOUT=30
```

### è¿è¡Œ

```bash
cargo run
```

## é›†æˆæµ‹è¯•

æœ¬é¡¹ç›®åŒ…å«äº†å®Œæ•´çš„é›†æˆæµ‹è¯•ç³»ç»Ÿï¼Œä½¿ç”¨ Mock å¯¹è±¡æ¥æ¨¡æ‹Ÿ Telegram APIã€‚

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰é›†æˆæµ‹è¯•
cargo test --test integration_tests

# æŸ¥çœ‹è¯¦ç»†è¾“å‡º
cargo test --test integration_tests -- --nocapture

# è¿è¡Œç‰¹å®šæµ‹è¯•
cargo test --test integration_tests test_message_parser
```

### æµ‹è¯•è¦†ç›–èŒƒå›´

#### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- âœ… **æ¶ˆæ¯è§£æå™¨æµ‹è¯•**: æµ‹è¯•é’±åŒ…æ¶ˆæ¯æ ¼å¼è§£æ
- âœ… **æ•°æ®åº“æ“ä½œæµ‹è¯•**: æµ‹è¯•é’±åŒ…åˆ›å»ºã€æ›´æ–°ã€äº¤æ˜“è®°å½•
- âœ… **Mock Bot APIæµ‹è¯•**: æµ‹è¯•æ¶ˆæ¯å‘é€ã€ç¼–è¾‘ã€åˆ é™¤

#### ä¸šåŠ¡é€»è¾‘æµ‹è¯•
- âœ… **å®Œæ•´æ¶ˆæ¯æµç¨‹æµ‹è¯•**: æµ‹è¯•ç«¯åˆ°ç«¯çš„æ¶ˆæ¯å¤„ç†æµç¨‹
- âœ… **é”™è¯¯å¤„ç†æµ‹è¯•**: æµ‹è¯•å„ç§æ— æ•ˆæ¶ˆæ¯æ ¼å¼çš„å¤„ç†
- âœ… **é‡å¤æ¶ˆæ¯å¤„ç†æµ‹è¯•**: æµ‹è¯•æ¶ˆæ¯å»é‡æœºåˆ¶

#### æ€§èƒ½å’Œå¹¶å‘æµ‹è¯•
- âœ… **æ€§èƒ½æµ‹è¯•**: æµ‹è¯•æ¶ˆæ¯è§£æå’Œæ•°æ®åº“æ“ä½œçš„æ€§èƒ½
- âœ… **å¹¶å‘æ“ä½œæµ‹è¯•**: æµ‹è¯•å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å®‰å…¨æ€§

### æµ‹è¯•ç»“æœç¤ºä¾‹

```
running 8 tests
âœ… å¹¶å‘æ“ä½œæµ‹è¯•é€šè¿‡
âœ… æ€§èƒ½æµ‹è¯•ç»“æœ:
  - 1000æ¬¡æ¶ˆæ¯è§£æè€—æ—¶: 28.3446ms
  - 100æ¬¡æ•°æ®åº“æ“ä½œè€—æ—¶: 1.0065758s
  - å¹³å‡å•æ¬¡è§£æè€—æ—¶: 28.344Âµs
  - å¹³å‡å•æ¬¡æ•°æ®åº“æ“ä½œè€—æ—¶: 10.065758ms
âœ… é‡å¤æ¶ˆæ¯å¤„ç†æµ‹è¯•é€šè¿‡
âœ… å®Œæ•´æ¶ˆæ¯å¤„ç†æµç¨‹æµ‹è¯•é€šè¿‡
âœ… Mock Bot APIæµ‹è¯•é€šè¿‡
âœ… æ•°æ®åº“æ“ä½œæµ‹è¯•é€šè¿‡
âœ… æ¶ˆæ¯è§£æå™¨æµ‹è¯•é€šè¿‡
âœ… é”™è¯¯å¤„ç†æµ‹è¯•é€šè¿‡

test result: ok. 8 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out
```

## ä½¿ç”¨æ–¹æ³•

### æ”¯æŒçš„æ¶ˆæ¯æ ¼å¼

```
#é’±åŒ…åç§° #æœˆä»½ #å¹´ä»½
#äº¤æ˜“ç±»å‹ é‡‘é¢å…ƒ
```

#### ç¤ºä¾‹

```
#æ”¯ä»˜å® #12æœˆ #2024å¹´
#å‡ºè´¦ 150.00å…ƒ
```

æœºå™¨äººä¼šè‡ªåŠ¨è®¡ç®—ä½™é¢å¹¶æ›´æ–°æ¶ˆæ¯ï¼š

```
#æ”¯ä»˜å® #12æœˆ #2024å¹´
#å‡ºè´¦ 150.00å…ƒ
#æ€»é¢ 1000.00å…ƒ
```

### æ”¯æŒçš„å‘½ä»¤

- `/start` - å¼€å§‹ä½¿ç”¨æœºå™¨äºº
- `/help` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
- `/status` - æŸ¥çœ‹æœºå™¨äººçŠ¶æ€
- `/reprocess` - é‡æ–°å¤„ç†æ¶ˆæ¯ï¼ˆå›å¤ç›®æ ‡æ¶ˆæ¯ï¼‰

## æ¶æ„è®¾è®¡

### æ¨¡å—ç»“æ„

```
src/
â”œâ”€â”€ bot/              # æœºå™¨äººæ ¸å¿ƒ
â”‚   â”œâ”€â”€ handler.rs    # æ¶ˆæ¯å¤„ç†å™¨
â”‚   â”œâ”€â”€ commands.rs   # å‘½ä»¤å¤„ç†
â”‚   â””â”€â”€ traits.rs     # Bot API æŠ½è±¡
â”œâ”€â”€ database/         # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ models.rs     # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ operations.rs # æ•°æ®åº“æ“ä½œ
â”œâ”€â”€ parser/           # æ¶ˆæ¯è§£æ
â”‚   â”œâ”€â”€ message.rs    # æ¶ˆæ¯è§£æå™¨
â”‚   â””â”€â”€ regex.rs      # æ­£åˆ™è¡¨è¾¾å¼
â”œâ”€â”€ calculator/       # ä½™é¢è®¡ç®—
â”‚   â””â”€â”€ balance.rs    # ä½™é¢è®¡ç®—å™¨
â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ settings.rs   # é…ç½®è®¾ç½®
â”œâ”€â”€ error.rs          # é”™è¯¯å¤„ç†
â”œâ”€â”€ retry.rs          # é‡è¯•æœºåˆ¶
â”œâ”€â”€ utils.rs          # å·¥å…·å‡½æ•°
â””â”€â”€ main.rs           # ä¸»å…¥å£
```

### æµ‹è¯•æ¶æ„

```
tests/
â””â”€â”€ integration_tests.rs  # é›†æˆæµ‹è¯•
    â”œâ”€â”€ MockBotApi        # Mock Telegram API
    â”œâ”€â”€ åŸºç¡€åŠŸèƒ½æµ‹è¯•        # æ¶ˆæ¯è§£æã€æ•°æ®åº“ã€Mock API
    â”œâ”€â”€ ä¸šåŠ¡é€»è¾‘æµ‹è¯•        # å®Œæ•´æµç¨‹ã€é”™è¯¯å¤„ç†ã€å»é‡
    â””â”€â”€ æ€§èƒ½å¹¶å‘æµ‹è¯•        # æ€§èƒ½åŸºå‡†ã€å¹¶å‘å®‰å…¨
```

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ç›¸åº”æ¨¡å—ä¸­æ·»åŠ åŠŸèƒ½ä»£ç 
2. åœ¨ `tests/integration_tests.rs` ä¸­æ·»åŠ æµ‹è¯•ç”¨ä¾‹
3. è¿è¡Œæµ‹è¯•ç¡®ä¿ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½

### æµ‹è¯•é©±åŠ¨å¼€å‘

```rust
#[tokio::test]
#[serial]
async fn test_new_feature() -> Result<()> {
    let db = create_test_db().await?;
    let mock_bot = MockBotApi::new();
    
    // æµ‹è¯•é€»è¾‘
    
    println!("âœ… æ–°åŠŸèƒ½æµ‹è¯•é€šè¿‡");
    Ok(())
}
```

### æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨ `cargo test --test integration_tests test_performance` æ£€æŸ¥æ€§èƒ½
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢å’Œæ¶ˆæ¯è§£æé€»è¾‘
- ç›‘æ§å¹¶å‘æ“ä½œçš„å®‰å…¨æ€§

## è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š

1. æŸ¥çœ‹ [é›†æˆæµ‹è¯•æ–‡æ¡£](INTEGRATION_TESTS.md)
2. åˆ›å»º Issue æè¿°é—®é¢˜
3. æäº¤ Pull Request ä¿®å¤é—®é¢˜

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œç”¨äºå±•ç¤º Rust ä¸­çš„é›†æˆæµ‹è¯•å®ç°ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿æ­£ç¡®é…ç½®æ‰€æœ‰å®‰å…¨è®¾ç½®ã€‚ 